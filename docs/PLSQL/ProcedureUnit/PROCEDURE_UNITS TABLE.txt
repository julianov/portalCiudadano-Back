CREATE TABLE "CIUDADANOS"."PROCEDURE_UNITS" 
(
  "ID" NUMBER(19,0) NOT NULL ENABLE, 
  "TITLE" VARCHAR2(1024 BYTE) NOT NULL ENABLE, 
  "STATE" VARCHAR2(1024 BYTE),
  "DESCRIPTION" CLOB,
  "FORMS" CLOB NOT NULL ENABLE,
  "THEME" VARCHAR2(2048 BYTE),
  "ATTACHMENTS" CLOB,
  "CITIZEN_LEVEL" VARCHAR2 (128 BYTE),
  "SECRETARY" VARCHAR" (1024 BYTE),
  "CREATED_AT" TIMESTAMP (6) DEFAULT SYSTIMESTAMP,
  "UPDATED_AT" TIMESTAMP (6),
  "CREATED_BY" NUMBER(19,0) NOT NULL ENABLE,
  "UPDATED_BY" NUMBER(19,0),
  CONSTRAINT "PROCEDURE_UNITS_ID_PK" PRIMARY KEY ("ID")
    USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
    STORAGE (INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
    PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
    BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
    TABLESPACE "APPSDATA" ENABLE, 
  CONSTRAINT "PROCEDURE_UNITS_CREATED_BY_FK" FOREIGN KEY ("CREATED_BY")
    REFERENCES "CIUDADANOS"."USERS" ("ID") ON DELETE CASCADE ENABLE, 
  CONSTRAINT "PROCEDURE_UNITS_UPDATED_BY_FK" FOREIGN KEY ("UPDATED_BY")
    REFERENCES "CIUDADANOS"."USERS" ("ID") ON DELETE CASCADE ENABLE
) 
SEGMENT CREATION DEFERRED 
PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
NOCOMPRESS LOGGING
STORAGE (INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
TABLESPACE "APPSDATA";

CREATE SEQUENCE CIUDADANOS.PROCEDURE_UNITS_SEQ
  START WITH 1
  INCREMENT BY 1
  NOCACHE
  NOCYCLE;
  
CREATE OR REPLACE TRIGGER "CIUDADANOS"."PROCEDURE_UNITS_ID_TRG" 
BEFORE INSERT ON "CIUDADANOS"."PROCEDURE_UNITS"
FOR EACH ROW
BEGIN
    IF :new.ID IS NULL THEN
        SELECT "CIUDADANOS"."PROCEDURE_UNITS_SEQ".NEXTVAL INTO :new.ID FROM dual;
    END IF;
END;
/
ALTER TRIGGER "CIUDADANOS"."PROCEDURE_UNITS_ID_TRG" ENABLE;

CREATE OR REPLACE TRIGGER "CIUDADANOS"."FORMS_CREATE_UPDATE_UNITS_TRG" 
BEFORE INSERT OR UPDATE ON "CIUDADANOS"."FORMS_UNITS"
FOR EACH ROW
BEGIN
    IF INSERTING THEN
        :NEW.CREATED_AT := SYSTIMESTAMP;
    END IF;
    IF UPDATING THEN
        :NEW.UPDATED_AT := SYSTIMESTAMP;
    END IF;
END;
/
ALTER TRIGGER "CIUDADANOS"."FORMS_CREATE_UPDATE_UNITS_TRG" ENABLE;
